<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Narraverso</title>
    <link rel="stylesheet" href="css/estilomenu.css">
    <script src="menu.js"></script>
</head>
<body>
    <?php
        session_start();
        $usuarioLogado = isset($_SESSION['id']);
        $erroLogin = isset($_GET['erro']) && (
            !empty($_SESSION['errosObrigatorios']) ||
            !empty($_SESSION['errosSenha']) ||
            !empty($_SESSION['erroFoto']) ||
            !empty($_SESSION['erroLogin']) ||
            !empty($_SESSION['erroEmail'])
        );
    ?>

   <header>
    
        <nav class="nav-bar-principal">
            <div class="nav-list-icone-menu">
                <ul>
                    <li class="nav-item">
                        <a href="#" id="menu-toggle" class="nav-link">
                            <img src="imagens/menu-bege.png" alt="menu" />
                        </a>
                    </li>
                </ul>
            </div>

            <div id="menu" class="nav-list-menu">
                <ul>
                    <li class="nav-item"><a href="index.php" class="nav-link-casa"><img src="imagens/casa-verde.png" alt="casa">      Página Inicial</a></li>
                    <li class="nav-item"><a href="quemSomos.php" class="nav-link"><img src="imagens/quem-somos-bege.png" alt="quem-somos">  Quem Somos</a></li>
                    <li class="nav-item"><a href="pesquisa.php" class="nav-link"><img src="imagens/pesquisa-bege.png" alt="pesquisa">  Pesquisar</a></li>
                    <li class="nav-item"><a href="" class="nav-link"><img src="imagens/coracao-bege.png" alt="Favoritos">  Favoritos</a></li>
                    <li class="nav-item"><a href="cadObra01.php" class="nav-link"><img src="imagens/mais-bege.png" alt="mais">  Cadastrar novas obras</a></li>
                    <li class="nav-item"><a href="configuracoes.php" class="nav-link"><img src="imagens/configuracoes-bege.png" alt="configuracao">  Configurações</a></li>
                </ul>
            </div>
        </nav>

        <nav class="nav-bar-logo">
        <div class="nav-list-logo">
                <ul>
                    <!-- Ícone 6: text-narraverso -->
                    <li class="nav-item">
                        <a  class="nav-link-text-narraverso">
                            <img src="imagens/text-narraverso.png" alt="text-narraverso"/>
                        </a>
                    </li>
                </ul>
            </div>
            </nav>


            <nav class="nav-bar-sino">
            <div class="nav-list-sino">
                <ul>
                    <!-- Ícone 7: Sino -->
                    <li class="nav-item">
                        <a href="" class="nav-link-sino">
                            <img src="imagens/sino-bege.png" alt="Sino"/>
                        </a>
                    </li>
                </ul>
            </div>
            </nav>

            <nav class="nav-bar-login">
            <div class="nav-list-login">
                <ul>
                    <!-- Ícone 7: Contato -->
                    <li class="nav-item">
                        <a href="<?= $usuarioLogado ? 'perfil_pessoal.php' : '#' ?>" class="nav-link-login"
                           <?php if (!$usuarioLogado) echo 'onclick="loginShow()"'; ?>>
                           
                            <img src="imagens/usuario-bege.png" alt="Usuario"/>
                        </a>
                    </li>
                </ul>
            </div>
            </nav>



    
        <nav class="nav-bar-filtro">
            <div class="nav-list-filtro">
                <ul>
                    <!-- Ícone 8: Filtro -->
                    <li class="nav-item">
                        <a href="" class="nav-link-filtro" id="filtrar-btn">
                            <img src="imagens/filtro-vermelho.png" alt="filtro" id="filtro-img" />
                        </a>

                    </li>
                    
                </ul>
            </div>
        </nav>

        

        <!-- parte do login e cadastrar pessoa -->
        <div class="logar-cad">
            <h3 class="texto-logar-cad" style="margin-top: 20px;">Você não possui uma <br> conta conectada!</h3>
            <div class="login-button">
                <button onclick="logar()">Entrar</button>
                <button onclick="cadastrar()">Cadastrar</button>
                <br>
                 <a class="aVoltar" href="#" onclick="fecharLogarCad()">Voltar</a>
            </div>
            </div>

            
            <div class="logar">
            <h3 class="texto-logar-cad">Login</h3>
            <form name="login" action="login02.php" method="POST"> 

                <h5 class="texto-logar-cad" style="margin-top: 20px;">Email: <br></h5> 
                <input type="text" name="email" id="email" value="" maxlength="150">
                <h5 class="texto-logar-cad">Senha: <br></h5> 
                <div class="senha-container">
                    <input type="password" name="senhaUsu" id="senhaUsu" value="" maxlength="50">
                    <span class="olho-span" onclick="mostrarSenha()">
                        <img class="olho-mostra" src="imagens/olho-fechado.png" alt="mostrar/esconder senha">
                    </span>
                </div>
                <br>
                <a class="aVoltar" href="#" onclick="fecharLogin()">Voltar</a>
                <br>
                <div class="login-button">
                <input type="submit" name="btEnviar" value="Enviar Dados">
                <br>
            </form>
            <!-- Botão separado do form para evitar envio -->
        <button type="button" onclick="esqueciSenha()">Esqueci a senha</button>
        </div>
        </div>

        <div class="esqueciSenha" style="display: none;">
        <h3 class="texto-logar-cad">Recuperar senha</h3>
        <form name="login" action="esqueciSenha02.php" method="POST"> 

            <h5 class="texto-logar-cad" style="margin-top: 20px;">Email: <br></h5> 
            <input type="text" name="email" id="email" value="" maxlength="150">
            <br>
            <a class="aVoltar" href="#" onclick="voltarLogin()">Voltar</a>
            <br>
            <div class="login-button">
            <input type="submit" name="btEnviar" value="Enviar">
            <br>
        </form>
    </div>
                    
    </header>

    <?php if ($erroLogin): ?>
    <?php include 'erro_modal.php'; ?>
    <?php endif; ?>

    <?php 
        if (isset($_SESSION['sucessoLogin'])) {
            include 'sucesso_modal.html';
            unset($_SESSION['sucessoLogin']); //Para exibir apenas uma vez
        }
    ?>


    <div class="carrossel">
            <div class="carrossel-track">
                <div class="carrossel-item"><img src="imagens/carrossel1.png" alt="carrossel-img 1"></div>
                <div class="carrossel-item"><img src="imagens/carrossel2.png" alt="carrossel-img 2"></div>
                <div class="carrossel-item"><img src="imagens/carrossel3.png" alt="carrossel-img 3"></div>
            </div>
        </div>



    <!--Mostrar as obras-->
    <div class="container-principal-obras">
        <h2 class="obras-titulo" id="titulo-filme">FILMES:</h2>
        <ul class="container-obras-index" id="container-filme">
            <?php 
                require("tccbdconnecta.php");


                if (!$conn) {
                    die("Erro com a conexão com o banco de dados: " .mysqli_connect_error());
                }

                $sql = "SELECT nome, fotoPerfil, categoria, genero FROM tcc_obra WHERE categoria = 'filme'"; //like verifica se pesquisa é igual nome da obra. % por antes (qualquer letras antes de pesquisa) e depois (qualquer letras depois de pesquisa)

                $resultado = mysqli_query($conn, $sql);

                if (!$resultado) {
                    die("Erro ao fazer a consulta SQL: " .mysqli_connect_error($conn));
                }

                if (mysqli_num_rows($resultado) > 0) { //quatas linhas retornou da nossa pesquisa
                    while ($dados = mysqli_fetch_assoc($resultado)){ //mostra resultado da pesquisa 
                        $fotoObra = !empty($dados['fotoPerfil']) ? $dados['fotoPerfil'] : 'imagens/imagem-obras.png';
                        $nome = $dados['nome'];
                        $categoria = $dados['categoria'];
                        $genero = $dados['genero'];

                        echo '<li class="obras" data-tipo="' . $categoria .'"  data-genero="' . $genero . '">
                        <div class="obras-image">
                            <img id="preview-obra" src="' . $fotoObra . '" alt="Imagem da obra">
                        </div>
                        <div class="conteudo-obras">
                            <h2 class="conteudo-nome">
                                '. $nome .'
                            </h2>
                        </div>
                    </li>';
                    } //enquanto houver resultado aparece
                } else {
                    echo '<li id="sem_resultado">
                        <p>Nenhuma obra encontrada!</p>
                    </li>';
                }
            ?>
            <span class="seta-esquerda">
                <img id="setaEsquerdaFilme" src="imagens/seta-esquerda-obra-verde.png" alt="seta esquerda">
            </span>
            <span class="seta-direita">
                <img id="setaDireitaFilme" src="imagens/seta-direita-obra-verde.png" alt="seta direita">
            </span>
        </ul>    

        <h2 class="obras-titulo" id="titulo-serie">SÉRIES:</h2>
        <ul class="container-obras-index" id="container-serie">
            <?php 
                require("tccbdconnecta.php");


                if (!$conn) {
                    die("Erro com a conexão com o banco de dados: " .mysqli_connect_error());
                }

                $sql2 = "SELECT nome, fotoPerfil, categoria, genero FROM tcc_obra WHERE categoria = 'serie'"; //like verifica se pesquisa é igual nome da obra. % por antes (qualquer letras antes de pesquisa) e depois (qualquer letras depois de pesquisa)

                $resultado2 = mysqli_query($conn, $sql2);

                if (!$resultado2) {
                    die("Erro ao fazer a consulta SQL: " .mysqli_connect_error($conn));
                }

                if (mysqli_num_rows($resultado2) > 0) { //quatas linhas retornou da nossa pesquisa
                    while ($dados = mysqli_fetch_assoc($resultado2)){ //mostra resultado da pesquisa 
                        $fotoObra = !empty($dados['fotoPerfil']) ? $dados['fotoPerfil'] : 'imagens/imagem-obras.png';
                        $nome = $dados['nome'];
                        $categoria = $dados['categoria'];
                        $genero = $dados['genero'];

                        echo '<li class="obras" data-tipo="' . $categoria .'"  data-genero="' . $genero . '">
                        <div class="obras-image">
                            <img id="preview-obra" src="' . $fotoObra . '" alt="Imagem da obra">
                        </div>
                        <div class="conteudo-obras">
                            <h2 class="conteudo-nome">
                                '. $nome .'
                            </h2>
                        </div>
                    </li>';
                    } //enquanto houver resultado aparece
                } else {
                    echo '<li id="sem_resultado">
                        <p>Nenhuma obra encontrada!</p>
                    </li>';
                }
            ?>
            <span class="seta-esquerda">
                <img id="setaEsquerdaSerie" src="imagens/seta-esquerda-obra-verde.png" alt="seta esquerda">
            </span>
            <span class="seta-direita">
                <img id="setaDireitaSerie" src="imagens/seta-direita-obra-verde.png" alt="seta direita">
            </span>
        </ul>    

        <h2 class="obras-titulo" id="titulo-livro">LIVROS:</h2>
        <ul class="container-obras-index" id="container-livro">
            <?php 
                require("tccbdconnecta.php");


                if (!$conn) {
                    die("Erro com a conexão com o banco de dados: " .mysqli_connect_error());
                }

                $sql3 = "SELECT nome, fotoPerfil, categoria, genero FROM tcc_obra WHERE categoria = 'livro'"; //like verifica se pesquisa é igual nome da obra. % por antes (qualquer letras antes de pesquisa) e depois (qualquer letras depois de pesquisa)

                $resultado3 = mysqli_query($conn, $sql3);

                if (!$resultado3) {
                    die("Erro ao fazer a consulta SQL: " .mysqli_connect_error($conn));
                }

                if (mysqli_num_rows($resultado3) > 0) { //quatas linhas retornou da nossa pesquisa
                    while ($dados = mysqli_fetch_assoc($resultado3)){ //mostra resultado da pesquisa 
                        $fotoObra = !empty($dados['fotoPerfil']) ? $dados['fotoPerfil'] : 'imagens/imagem-obras.png';
                        $nome = $dados['nome'];
                        $categoria = $dados['categoria'];
                        $genero = $dados['genero'];

                        echo '<li class="obras" data-tipo="' . $categoria .'"  data-genero="' . $genero . '">
                        <div class="obras-image">
                            <img id="preview-obra" src="' . $fotoObra . '" alt="Imagem da obra">
                        </div>
                        <div class="conteudo-obras">
                            <h2 class="conteudo-nome">
                                '. $nome .'
                            </h2>
                        </div>
                    </li>';
                    } //enquanto houver resultado aparece
                } else {
                    echo '<li id="sem_resultado">
                        <p>Nenhuma obra encontrada!</p>
                    </li>';
                }
            ?>
            <span class="seta-esquerda">
                <img id="setaEsquerdaLivro" src="imagens/seta-esquerda-obra-verde.png" alt="seta esquerda">
            </span>
            <span class="seta-direita">
                <img id="setaDiretaLivro" src="imagens/seta-direita-obra-verde.png" alt="seta direita">
            </span>
        </ul>    
    </div>
            


    <!-- Tela de Filtro -->
<div id="filtroModal" class="filtro-overlay">
    <div class="filtro-container">
        <h2>Filtrar por:</h2>
        <br>

        <h3>Tipo:</h3>
        <span data-tipo="filme">Filme &nbsp;</span>
        <span data-tipo="serie">Série &nbsp;</span>
        <span data-tipo="livro">Livro</span>
        <br>
        <br>

        <h3>Gênero:</h3>
        <div class="genero-lista">
            <span data-genero="acao">Ação</span>
            <span data-genero="adolescencia">Adolescência</span>
            <span data-genero="animacao">Animação</span>
            <span data-genero="anime">Anime</span>
            <span data-genero="aventura">Aventura</span>
            <span data-genero="biografia">Biografia</span>
            <span data-genero="classico">Clássico</span>
            <span data-genero="comedia">Comédia</span>
            <span data-genero="crime">Crime</span>
            <span data-genero="distopia">Distopia</span>
            <span data-genero="documentario">Documentário</span>
            <span data-genero="drama">Drama</span>
            <span data-genero="drama-asiatico">Drama Asiático</span>
            <span data-genero="esporte">Esporte</span>
            <span data-genero="familia">Família</span>
            <span data-genero="fantasia">Fantasia</span>
            <span data-genero="fabula">Fábula</span>
            <span data-genero="ficcao">Ficção</span>
            <span data-genero="ficcao-cientifica">Ficção Científica</span>
            <span data-genero="filosofia">Filosofia</span>
            <span data-genero="historico">Histórico</span>
            <span data-genero="lgbtqia">LGBTQIA+</span>
            <span data-genero="mistério">Mistério</span>
            <span data-genero="musical">Musical</span>
            <span data-genero="novela">Novela</span>
            <span data-genero="policial">Policial</span>
            <span data-genero="politica">Política</span>
            <span data-genero="romance">Romance</span>
            <span data-genero="suspense">Suspense</span>
            <span data-genero="terror">Terror</span>
        </div>
        <br>

        <a class="fechar-filtro" onclick="fecharFiltro()">Voltar</a>

        <button id="getSelecionar">Confirmar</button>
    </div>
</div>

<div id="trilho"></div> <!--Para funcionar modo escuro-->

</body>
</html>
